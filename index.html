<!DOCTYPE html>
<html>
<head>
    <title>Car Price Predictor</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        select, input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; }
        .result { margin-top: 20px; padding: 15px; border-radius: 4px; }
        .current { background-color: #e7f3e7; border: 1px solid #4CAF50; }
        .future { background-color: #e7f3ff; border: 1px solid #2196F3; }
    </style>
</head>
<body>
    <h1>Car Price Predictor</h1>
    
    <form id="predictionForm">
        <div class="form-group">
            <label for="make">Company:</label>
            <select id="make" name="make" required>
                <option value="">Select Company</option>
                {% for make in makes %}
                <option value="{{ make }}">{{ make }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="model">Model:</label>
            <select id="model" name="model" required>
                <option value="">Select Model</option>
                {% for model in models %}
                <option value="{{ model }}">{{ model }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="year">Year:</label>
            <input type="number" id="year" name="year" min="1999" max="2024" value="2013" required>
        </div>
        
        <div class="form-group">
            <label for="km_driven">KM's Driven:</label>
            <input type="number" id="km_driven" name="km_driven" value="102785" required>
        </div>
        
        <div class="form-group">
            <label for="fuel">Fuel:</label>
            <select id="fuel" name="fuel" required>
                <option value="Petrol">Petrol</option>
                <option value="Diesel">Diesel</option>
                <option value="CNG">CNG</option>
                <option value="Hybrid">Hybrid</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="car_documents">Car Documents:</label>
            <select id="car_documents" name="car_documents" required>
                <option value="Original">Original</option>
                <option value="Duplicate">Duplicate</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="assembly">Assembly:</label>
            <select id="assembly" name="assembly" required>
                <option value="Local">Local</option>
                <option value="Imported">Imported</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="transmission">Transmission:</label>
            <select id="transmission" name="transmission" required>
                <option value="Manual">Manual</option>
                <option value="Automatic">Automatic</option>
            </select>
        </div>
        
        <button type="submit">Predict Current Price</button>
    </form>
    
    <div id="currentResult" class="result current" style="display: none;">
        <h3>Predicted Current Price: <span id="currentPrice"></span></h3>
        <button id="futureBtn">Check Future Price</button>
    </div>
    
    <div id="futureSection" style="display: none; margin-top: 20px;">
        <label for="years">Select years ahead for future price prediction:</label>
        <select id="years">
            <option value="1">1 Year</option>
            <option value="2">2 Years</option>
            <option value="3">3 Years</option>
            <option value="4">4 Years</option>
            <option value="5">5 Years</option>
        </select>
        <button id="predictFutureBtn">Predict Future Price</button>
    </div>
    
    <div id="futureResult" class="result future" style="display: none;">
        <h3>Predicted Future Price in <span id="yearsAhead"></span> years: <span id="futurePrice"></span></h3>
    </div>

    <script>
        document.getElementById('predictionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    make: document.getElementById('make').value,
                    model: document.getElementById('model').value,
                    year: document.getElementById('year').value,
                    km_driven: document.getElementById('km_driven').value,
                    fuel: document.getElementById('fuel').value,
                    car_documents: document.getElementById('car_documents').value,
                    assembly: document.getElementById('assembly').value,
                    transmission: document.getElementById('transmission').value
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('currentPrice').textContent = 'PKR: ' + data.current_price.toLocaleString('en-PK', {maximumFractionDigits: 2});
                    document.getElementById('currentResult').style.display = 'block';
                    document.getElementById('futureSection').style.display = 'block';
                    document.getElementById('futureResult').style.display = 'none';
                    
                    // Store input data for future prediction
                    window.inputData = data.input_data;
                } else {
                    alert('Error: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while predicting the price.');
            });
        });
        
        document.getElementById('futureBtn').addEventListener('click', function() {
            document.getElementById('futureSection').style.display = 'block';
        });
        
        document.getElementById('predictFutureBtn').addEventListener('click', function() {
            const years = document.getElementById('years').value;
            
            fetch('/predict_future', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    input_data: window.inputData,
                    years: parseInt(years)
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    document.getElementById('futurePrice').textContent = 'PKR: ' + data.future_price.toLocaleString('en-PK', {maximumFractionDigits: 2});
                    document.getElementById('yearsAhead').textContent = data.years;
                    document.getElementById('futureResult').style.display = 'block';
                } else {
                    alert('Error: ' + data.error);
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while predicting the future price.');
            });
        });
    </script>
</body>
</html>
